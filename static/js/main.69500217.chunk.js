(this["webpackJsonpsff-taobao-items"]=this["webpackJsonpsff-taobao-items"]||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n(0),c=n.n(a),i=n(13),o=n.n(i),s=(n(97),n(23)),l=n.n(s),b=n(35),d=n(25),u=n(38),j=(n(99),n(79)),p=n(148),h=n(151),m=n(152),O=n(149),f=n(64),x=n(139),g=n(144),v=n(145),y=n(146),k=n(147),w=n(150),S=n(141),C=n.n(S),I=n(142),N=n(78),$=n(48),E=n.n($),F=n(15),z=n(65),A={root:null,threshold:.5,rootMargin:"0px"},L=function(e,t){var n=Object(a.useState)(null),r=Object(d.a)(n,2),c=r[0],i=r[1],o=Object(a.useCallback)((function(t,n){var r=Object(d.a)(t,1)[0];r.isIntersecting&&e(r,n)}),[]);return Object(a.useEffect)((function(){var e;return c&&(e=new IntersectionObserver(o,Object(z.a)(Object(z.a)({},A),t))).observe(c),function(){return e&&e.disconnect()}}),[c,t.root,t.threshold,t.rootMargin,o]),[c,i]};function T(){var e=Object(u.a)(["\n  mutation removeItem($id: String!) {\n    removeItem(\n      id: $id\n    )\n  }\n"]);return T=function(){return e},e}function B(){var e=Object(u.a)(["\n  mutation addItem($title: String!, $price: [Float!]!, $link: String!, $description: String!, $imageLink: String!) {\n    addItem(\n      title: $title,\n      price: $price,\n      link: $link,\n      description: $description,\n      imageLink: $imageLink\n    )\n  }\n"]);return B=function(){return e},e}function D(){var e=Object(u.a)(["\n  query batchItem($start: Int) {\n    batchItem(start: $start) {\n      id\n      title\n      price\n      link\n      description\n      imageLink\n    }\n  }\n"]);return D=function(){return e},e}var M={title:"",price:[null,null],link:"",description:"",imageLink:""},R=Object(x.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",padding:0,borderStyle:"solid",borderWidth:"1px",borderColor:"rgba(0, 0, 0, 0.23)",boxShadow:"none",marginBottom:e.spacing(1),textAlign:"left"},details:{overflow:"hidden",overflowWrap:"break-word"},content:{padding:e.spacing(1),flex:"1 0 auto"},cover:{minWidth:150,backgroundColor:"white",borderLeft:"1px solid rgba(0, 0, 0, 0.23)"},edit:{padding:0,borderStyle:"solid",borderWidth:"1px",borderColor:"rgba(0, 0, 0, 0.23)",boxShadow:"none",marginBottom:e.spacing(1),textAlign:"left"}}}));var W=C()(D()),J=C()(B()),_=C()(T()),U=function(e){var t=e.item,n=e.edit,a=e.refresh,c=R(),i=Object(I.a)(_),o=Object(d.a)(i,1)[0],s=function(){var e=Object(b.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({variables:{id:t.id}});case 2:if(n=e.sent,n.data.removeItem){e.next=6;break}return e.abrupt("return");case 6:a();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[n&&Object(r.jsxs)("div",{style:{marginBottom:3,textAlign:"right"},children:[Object(r.jsx)(m.a,{style:{backgroundColor:"lightblue",width:"20px !important",height:20},children:" EDIT "}),Object(r.jsx)(m.a,{onClick:s,style:{backgroundColor:"lightsalmon",width:"20px !important",height:20,marginLeft:3},children:" X "})]}),Object(r.jsxs)(g.a,{className:c.root,onClick:function(){var e;(e=t.link,new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e))&&window.open(t.link,"_blank")},children:[Object(r.jsx)("div",{className:c.details,children:Object(r.jsxs)(v.a,{className:c.content,children:[Object(r.jsx)(y.a,{component:"h6",variant:"h6",children:t.title}),Object(r.jsx)(y.a,{children:t.price.length<=1?"".concat(t.price[0],"\xa5"):"".concat(t.price[0],"-").concat(t.price[1],"\xa5")}),Object(r.jsx)(y.a,{variant:"subtitle1",color:"textSecondary",children:t.description})]})}),Object(r.jsx)(k.a,{className:c.cover,image:t.imageLink||"https://via.placeholder.com/150x150?text=No+Image"})]})]})},P=JSON.parse(JSON.stringify(M)),V=function(e,t){switch(t.type){case"UPDATE":return Object(N.a)(e,(function(e){E.a.set.apply(E.a,[e].concat([t.path,t.value]))}));case"RESET":return P;default:return e}},q=function(e){var t=e.prop,n=e.formState,a=e.updateForm,c=Object(d.a)(t,2),i=c[0],o=c[1];return Array.isArray(o)?Object(r.jsx)("div",{style:{display:"flex"},children:o.map((function(e,t){return Object(r.jsx)(w.a,{name:"".concat(i,"[").concat(t,"]"),label:"".concat(i," ").concat(t),fullWidth:!0,variant:"outlined",size:"small",style:{marginBottom:5},onChange:a,value:Object($.get)(n,"".concat(i,"[").concat(t,"]"))},"".concat(i,"[").concat(t,"]"))}))}):Object(r.jsx)(w.a,{name:i,label:i,fullWidth:!0,variant:"outlined",size:"small",style:{marginBottom:5},onChange:a,value:Object($.get)(n,"".concat(i))},i)},H=c.a.memo((function(e){var t=e.formState,n=e.updateForm;return Object.entries(M).map((function(e,a){return Object(r.jsx)(q,{prop:e,formState:t,updateForm:n},a)}))})),K=function(e){var t=e.refresh,n=R(),a=Object(I.a)(J),i=Object(d.a)(a,1)[0],o=c.a.useReducer(V,P),s=Object(d.a)(o,2),u=s[0],j=s[1],p=c.a.useCallback((function(e){var t=e.target,n=t.value,r=t.name;t.type;j({type:"UPDATE",path:r,value:n})}),[]),h=function(){var e=Object(b.a)(l.a.mark((function e(){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=JSON.parse(JSON.stringify(u))).price[0]=Number(n.price[0]),n.price[1]?n.price[1]=Number(n.price[1]):n.price.length=1,e.next=5,i({variables:n});case 5:r=e.sent,r.data.addItem&&(j({type:"RESET"}),t());case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsxs)(g.a,{className:n.edit,style:{padding:5},children:[Object(r.jsx)(H,{formState:u,updateForm:p}),Object(r.jsx)(m.a,{size:"small",onClick:function(){return h("")},style:{backgroundColor:"lightblue",float:"right"},children:"ADD"})]})]})},Q=function(e){var t=e.data,n=e.refetch,a=e.onLoadMore,c=e.isEdit,i=L(function(){var e=Object(b.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.unobserve(t.target),e.next=3,a();case 3:n.observe(t.target);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{}),o=Object(d.a)(i,2),s=(o[0],o[1]),u=t.batchItem;return Object(r.jsxs)("div",{children:[Object(r.jsx)("ul",{style:{padding:0},children:u.map((function(e,t){return Object(r.jsx)(U,{refresh:n,item:e,edit:c},t)}))}),Object(r.jsx)("div",{ref:s,className:"Loading"})]})},X=function(){var e,t=Object(I.b)(W),n=t.loading,a=t.error,c=t.data,i=t.fetchMore,o=t.refetch,s=!("/add"!==Object(F.g)().pathname),d=0;return Object(r.jsxs)(r.Fragment,{children:[s&&Object(r.jsx)(K,{refresh:o}),Object(r.jsx)("br",{}),n?Object(r.jsxs)("div",{children:["\ub85c\ub529\uc911..",Object(r.jsx)("br",{}),"(\ucd5c\ub300 20\ucd08\uae4c\uc9c0 \uc18c\uc694)"]}):a?Object(r.jsx)("div",{children:"Error"}):(0===d&&(d=c.batchItem.length),Object(r.jsx)(Q,{data:c,refetch:o,isEdit:s,onLoadMore:Object(b.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({variables:{start:d},updateQuery:function(t,n){var r=n.fetchMoreResult;return r?(e=d,d+=r.batchItem.length,e!==d?Object.assign({},t,{batchItem:[].concat(Object(f.a)(t.batchItem),Object(f.a)(r.batchItem))}):void 0):t}});case 2:case"end":return t.stop()}}),t)})))})),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]})},Y=n(58),G=n(57);function Z(){var e=Object(u.a)(["\n  mutation login($id: String!, $pw: String!) {\n    login(id: $id, pw: $pw) {\n      token\n      id\n    }\n  }\n"]);return Z=function(){return e},e}function ee(){var e=Object(u.a)(["\n  mutation {\n    isLogin\n  }\n"]);return ee=function(){return e},e}var te=Object(j.a)({typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Noto Sans KR"','"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")}}),ne=C()(ee()),re=C()(Z()),ae=function(){var e=Object(I.a)(re),t=Object(d.a)(e,1)[0];function n(){return(n=Object(b.a)(l.a.mark((function e(n){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t({variables:{id:n.target.elements.username.value,pw:n.target.elements.pwd.value}});case 3:(r=e.sent).data.login?((a=new Date).setTime(a.getTime()+36e5),G.set("authorization",r.data.login.token,{path:"/",expires:a}),window.location.href="/#/add"):alert("\uc798\ubabb\ub41c \uacc4\uc815 \uc815\ubcf4\uc785\ub2c8\ub2e4.");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)("div",{className:"text-center",children:Object(r.jsxs)("form",{onSubmit:function(e){return function(e){return n.apply(this,arguments)}(e)},children:[Object(r.jsx)("h3",{children:"\ub85c\uadf8\uc778"}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"\uc544\uc774\ub514"}),Object(r.jsx)("input",{name:"username",className:"form-control",placeholder:"\uc544\uc774\ub514 \uc785\ub825"})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"\ube44\ubc00\ubc88\ud638"}),Object(r.jsx)("input",{name:"pwd",type:"password",className:"form-control",placeholder:"\ube44\ubc00\ubc88\ud638 \uc785\ub825"})]}),Object(r.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",children:"\ud655\uc778"})]})})})},ce=c.a.createContext(null);var ie=function(){var e=Object(I.a)(ne),t=Object(d.a)(e,1)[0],n=Object(a.useState)(null),c=Object(d.a)(n,2),i=c[0],o=c[1];Object(a.useEffect)((function(){Object(b.a)(l.a.mark((function e(){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:n=e.sent,r=n.data,o((function(e){return r.isLogin}));case 5:case"end":return e.stop()}}),e)})))()}),[]);var s=function(){var e=Object(F.g)();return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(p.a,{maxWidth:"sm",style:{height:"100vh",padding:0},children:[Object(r.jsxs)(h.a,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:10},children:[Object(r.jsx)("h3",{children:"\ud0c0\uc624\ubc14\uc624 \uc7a1\ud15c\ubaa8\uc74c"}),Object(r.jsxs)("div",{children:[Object(r.jsx)(m.a,{onClick:function(){return window.open("https://gall.dcinside.com/mgallery/board/lists?id=sff","_blank")},style:{backgroundColor:"#F5C6C9"},children:"SFF\uac24"}),"\xa0\xa0",i?Object(r.jsx)(Y.b,{to:"/add"===e.pathname?"/":"/add",children:Object(r.jsx)(m.a,{style:{backgroundColor:"#eee"},children:"\uc218\uc815"})}):Object(r.jsx)(m.a,{onClick:function(){return window.open("https://forms.gle/38ejs1VSAT43YeEV6","_blank")},style:{backgroundColor:"#c6e6f5"},children:"\ucd94\uac00 \uc694\uccad"})]})]}),Object(r.jsx)(X,{})]})})};return Object(r.jsx)(O.a,{theme:te,children:Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(ce.Provider,{value:i,children:Object(r.jsx)(Y.a,{children:Object(r.jsxs)(F.d,{children:[Object(r.jsx)(F.b,{path:"/",exact:!0,component:s}),i&&Object(r.jsx)(F.b,{path:"/add",exact:!0,component:s}),Object(r.jsx)(F.b,{path:"/login",exact:!0,component:ae}),Object(r.jsx)(F.a,{to:"/"})]})})})})})},oe=n(19),se=n(36),le=n(81),be=n(80),de=G.get("authorization"),ue=Object(le.a)({uri:"https://sff-taobao-items-backend.herokuapp.com",credentials:"same-origin",headers:de?{Authorization:"".concat(de)}:{}}),je=new se.a({link:ue,cache:new be.a});o.a.render(Object(r.jsx)(oe.a,{client:je,children:Object(r.jsx)(ie,{})}),document.getElementById("root"))},97:function(e,t,n){},99:function(e,t,n){}},[[112,1,2]]]);
//# sourceMappingURL=main.69500217.chunk.js.map