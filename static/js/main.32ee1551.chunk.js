(this["webpackJsonpsff-taobao-items"]=this["webpackJsonpsff-taobao-items"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n(0),c=n.n(r),i=n(13),o=n.n(i),s=(n(88),n(27)),l=n.n(s),d=n(38),u=n(30),j=n(35),b=(n(90),n(73)),p=n(142),m=n(145),h=n(143),f=n(132),x=n(138),O=n(139),g=n(140),v=n(141),y=n(144),w=n(135),k=n.n(w),S=n(136),N=n(72),C=n(44),$=n.n(C);function I(){var e=Object(j.a)(["\n  mutation removeItem($id: String!) {\n    removeItem(\n      id: $id\n    )\n  }\n"]);return I=function(){return e},e}function z(){var e=Object(j.a)(["\n  mutation addItem($title: String!, $price: [Float!]!, $link: String!, $description: String!, $imageLink: String!) {\n    addItem(\n      title: $title,\n      price: $price,\n      link: $link,\n      description: $description,\n      imageLink: $imageLink\n    )\n  }\n"]);return z=function(){return e},e}function E(){var e=Object(j.a)(["\n  {\n    batchItem {\n      id\n      title\n      price\n      link\n      description\n      imageLink\n    }\n  }\n"]);return E=function(){return e},e}var F={title:"",price:[0,0],link:"",description:"",imageLink:""},A=Object(f.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",padding:0,borderStyle:"solid",borderWidth:"1px",borderColor:"rgba(0, 0, 0, 0.23)",boxShadow:"none",marginBottom:e.spacing(1),textAlign:"left"},details:{overflow:"hidden",overflowWrap:"break-word"},content:{padding:e.spacing(1),flex:"1 0 auto"},cover:{minWidth:150,backgroundColor:"white",borderLeft:"1px solid rgba(0, 0, 0, 0.23)"},edit:{padding:0,borderStyle:"solid",borderWidth:"1px",borderColor:"rgba(0, 0, 0, 0.23)",boxShadow:"none",marginBottom:e.spacing(1),textAlign:"left"}}}));var L=k()(E()),B=k()(z()),D=k()(I()),T=function(e){var t=e.item,n=e.edit,r=e.refresh,c=A(),i=Object(S.a)(D),o=Object(u.a)(i,1)[0],s=function(){var e=Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({variables:{id:t.id}});case 2:if(n=e.sent,n.data.removeItem){e.next=6;break}return e.abrupt("return");case 6:r();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[n&&Object(a.jsxs)("div",{style:{marginBottom:3,textAlign:"right"},children:[Object(a.jsx)(m.a,{style:{backgroundColor:"lightblue",width:"20px !important",height:20},children:" EDIT "}),Object(a.jsx)(m.a,{onClick:s,style:{backgroundColor:"lightsalmon",width:"20px !important",height:20,marginLeft:3},children:" X "})]}),Object(a.jsxs)(x.a,{className:c.root,onClick:function(){var e;(e=t.link,new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e))&&window.open(t.link,"_blank")},children:[Object(a.jsx)("div",{className:c.details,children:Object(a.jsxs)(O.a,{className:c.content,children:[Object(a.jsx)(g.a,{component:"h6",variant:"h6",children:t.title}),Object(a.jsx)(g.a,{children:t.price.length<=1?"".concat(t.price[0],"\xa5"):"".concat(t.price[0],"-").concat(t.price[1],"\xa5")}),Object(a.jsx)(g.a,{variant:"subtitle1",color:"textSecondary",children:t.description})]})}),Object(a.jsx)(v.a,{className:c.cover,image:t.imageLink||"https://via.placeholder.com/150x150?text=No+Image"})]})]})},W=JSON.parse(JSON.stringify(F)),J=function(e,t){switch(t.type){case"UPDATE":return Object(N.a)(e,(function(e){$.a.set.apply($.a,[e].concat([t.path,t.value]))}));case"RESET":return W;default:return e}},R=function(e){var t=e.prop,n=e.formState,r=e.updateForm,c=Object(u.a)(t,2),i=c[0],o=c[1];return Array.isArray(o)?Object(a.jsx)("div",{style:{display:"flex"},children:o.map((function(e,t){return Object(a.jsx)(y.a,{name:"".concat(i,"[").concat(t,"]"),label:"".concat(i," ").concat(t),fullWidth:!0,variant:"outlined",size:"small",style:{marginBottom:5},onChange:r,value:Object(C.get)(n,"".concat(i,"[").concat(t,"]"))},"".concat(i,"[").concat(t,"]"))}))}):Object(a.jsx)(y.a,{name:i,label:i,fullWidth:!0,variant:"outlined",size:"small",style:{marginBottom:5},onChange:r,value:Object(C.get)(n,"".concat(i))},i)},U=c.a.memo((function(e){var t=e.formState,n=e.updateForm;return Object.entries(F).map((function(e,r){return Object(a.jsx)(R,{prop:e,formState:t,updateForm:n},r)}))})),_=function(e){var t=e.refresh,n=A(),r=Object(S.a)(B),i=Object(u.a)(r,1)[0],o=c.a.useReducer(J,W),s=Object(u.a)(o,2),j=s[0],b=s[1],p=c.a.useCallback((function(e){var t=e.target,n=t.value,a=t.name;t.type;b({type:"UPDATE",path:a,value:n})}),[]),h=function(){var e=Object(d.a)(l.a.mark((function e(){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(j),(n=JSON.parse(JSON.stringify(j))).price[0]=Number(n.price[0]),n.price[1]=Number(n.price[1]),e.next=6,i({variables:n});case 6:a=e.sent,a.data.addItem&&(b({type:"RESET"}),t());case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("br",{}),Object(a.jsxs)(x.a,{className:n.edit,style:{padding:5},children:[Object(a.jsx)(U,{formState:j,updateForm:p}),Object(a.jsx)(m.a,{size:"small",onClick:function(){return h("")},style:{backgroundColor:"lightblue",float:"right"},children:"ADD"})]})]})},P=function(){var e=Object(S.b)(L),t=e.loading,n=e.error,r=e.data,c=e.refetch,i=!("/add"!==window.location.pathname);return Object(a.jsxs)(a.Fragment,{children:[i&&Object(a.jsx)(_,{refresh:c}),Object(a.jsx)("br",{}),Object(a.jsx)("div",{children:t?Object(a.jsx)("div",{children:"Fetching"}):n?Object(a.jsx)("div",{children:"Error"}):r.batchItem.map((function(e,t){return Object(a.jsx)(T,{refresh:c,item:e,edit:i},t)}))})]})},H=n(57),K=n(15),M=n(53);function X(){var e=Object(j.a)(["\n  mutation login($id: String!, $pw: String!) {\n    login(id: $id, pw: $pw) {\n      token\n      id\n    }\n  }\n"]);return X=function(){return e},e}function q(){var e=Object(j.a)(["\n  mutation {\n    isLogin\n  }\n"]);return q=function(){return e},e}var G=Object(b.a)({typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Noto Sans KR"','"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")}}),Q=k()(q()),V=k()(X()),Y=function(){var e=Object(S.a)(V),t=Object(u.a)(e,1)[0];function n(){return(n=Object(d.a)(l.a.mark((function e(n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t({variables:{id:n.target.elements.username.value,pw:n.target.elements.pwd.value}});case 3:(a=e.sent).data.login?((r=new Date).setTime(r.getTime()+36e5),M.set("authorization",a.data.login.token,{path:"/",expires:r}),window.location.href="/add"):alert("\uc798\ubabb\ub41c \uacc4\uc815 \uc815\ubcf4\uc785\ub2c8\ub2e4.");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{className:"text-center",children:Object(a.jsxs)("form",{onSubmit:function(e){return function(e){return n.apply(this,arguments)}(e)},children:[Object(a.jsx)("h3",{children:"\ub85c\uadf8\uc778"}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{children:"\uc544\uc774\ub514"}),Object(a.jsx)("input",{name:"username",className:"form-control",placeholder:"\uc544\uc774\ub514 \uc785\ub825"})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{children:"\ube44\ubc00\ubc88\ud638"}),Object(a.jsx)("input",{name:"pwd",type:"password",className:"form-control",placeholder:"\ube44\ubc00\ubc88\ud638 \uc785\ub825"})]}),Object(a.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",children:"\ud655\uc778"})]})})})},Z=c.a.createContext(null);var ee=function(){var e=Object(S.a)(Q),t=Object(u.a)(e,1)[0],n=Object(r.useState)(null),c=Object(u.a)(n,2),i=c[0],o=c[1];Object(r.useEffect)((function(){Object(d.a)(l.a.mark((function e(){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:n=e.sent,a=n.data,console.log(a.isLogin),o((function(e){return a.isLogin}));case 6:case"end":return e.stop()}}),e)})))()}),[]);var s=function(){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(p.a,{maxWidth:"sm",style:{height:"100vh",padding:0},children:[Object(a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(a.jsx)("h3",{children:"\ud0c0\uc624\ubc14\uc624 \uc7a1\ud15c\ubaa8\uc74c"}),i&&Object(a.jsx)(H.b,{to:"/add"===window.location.pathname?"/":"/add",children:Object(a.jsx)(m.a,{style:{backgroundColor:"#eee"},children:"\uc218\uc815"})})]}),Object(a.jsx)(P,{})]})})};return Object(a.jsx)(h.a,{theme:G,children:Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(Z.Provider,{value:i,children:Object(a.jsx)(H.a,{children:Object(a.jsxs)(K.d,{children:[Object(a.jsx)(K.b,{path:"/",exact:!0,component:s}),i&&Object(a.jsx)(K.b,{path:"/add",exact:!0,component:s}),Object(a.jsx)(K.b,{path:"/login",exact:!0,component:Y}),Object(a.jsx)(K.a,{to:"/"})]})})})})})},te=n(19),ne=n(33),ae=n(75),re=n(74),ce=M.get("authorization"),ie=Object(ae.a)({uri:"https://sff-taobao-items-backend.herokuapp.com",credentials:"same-origin",headers:ce?{Authorization:"".concat(ce)}:{}}),oe=new ne.a({link:ie,cache:new re.a});o.a.render(Object(a.jsx)(te.a,{client:oe,children:Object(a.jsx)(ee,{})}),document.getElementById("root"))},88:function(e,t,n){},90:function(e,t,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.32ee1551.chunk.js.map