{"version":3,"sources":["components/ItemListHomeDisplay.js","components/App.js","index.js"],"names":["propList","title","price","link","description","imageLink","useStyles","makeStyles","theme","root","display","justifyContent","padding","borderStyle","borderWidth","borderColor","boxShadow","marginBottom","spacing","textAlign","details","overflow","overflowWrap","content","flex","cover","minWidth","backgroundColor","borderLeft","edit","FEED_QUERY","gql","ADD_ITEM_MUTATION","REMOVE_ITEM_MUTATION","TaoItem","item","refresh","classes","useMutation","removeItem","onRemoveButtonClick","a","variables","id","data","style","Button","width","height","onClick","marginLeft","Card","className","str","RegExp","test","window","open","CardContent","Typography","component","variant","length","color","CardMedia","image","initialState","JSON","parse","stringify","formReducer","state","action","type","produce","draft","_","set","path","value","Field","prop","formState","updateForm","name","attr","Array","isArray","map","i","TextField","label","fullWidth","size","onChange","get","Form","React","memo","Object","entries","NewItem","addItem","useReducer","formDispatch","useCallback","target","submitForm","console","log","submit","Number","float","ItemListHomeDisplay","useQuery","loading","error","refetch","location","pathname","batchItem","createMuiTheme","typography","fontFamily","join","AUTH_CHECK","LOGIN","Login","login","e","preventDefault","elements","username","pw","pwd","res","expires","Date","setTime","getTime","Cookies","token","href","alert","onSubmit","d","loginRequest","placeholder","UserAuth","createContext","App","authCheck","useState","auth","setAuth","useEffect","isLogin","Home","Container","maxWidth","alignItems","to","ThemeProvider","Provider","exact","authorization","httpLink","createHttpLink","uri","credentials","headers","Authorization","client","ApolloClient","cache","InMemoryCache","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.1100da18.chunk.js","sourcesContent":["import { Button, Card, CardContent, CardMedia, makeStyles, TextField, Typography } from \"@material-ui/core\";\r\nimport { gql } from \"apollo-boost\";\r\nimport { useMemo, useState } from \"react\";\r\nimport { Query, useMutation, useQuery } from \"react-apollo\";\r\nimport React from 'react';\r\nimport produce from 'immer';\r\nimport _, { get, set } from 'lodash';\r\n\r\n\r\n\r\nconst propList = {\r\n  title: '',\r\n  price: [0, 0],\r\n  link: '',\r\n  description: '',\r\n  imageLink: ''\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n      display: 'flex',\r\n      justifyContent: 'space-between',\r\n      padding: 0,\r\n      borderStyle: 'solid',\r\n      borderWidth: '1px',\r\n      borderColor: 'rgba(0, 0, 0, 0.23)',\r\n      boxShadow: 'none',\r\n      marginBottom: theme.spacing(1),\r\n      textAlign: 'left'\r\n  },\r\n  details: {\r\n    overflow: 'hidden',\r\n    overflowWrap: 'break-word'\r\n  },\r\n  content: {\r\n      padding: theme.spacing(1),\r\n      flex: '1 0 auto'\r\n  },\r\n  cover: {\r\n      minWidth: 150,\r\n      backgroundColor: 'white',\r\n      borderLeft: '1px solid rgba(0, 0, 0, 0.23)',\r\n  },\r\n  edit: {\r\n    padding: 0,\r\n    borderStyle: 'solid',\r\n    borderWidth: '1px',\r\n    borderColor: 'rgba(0, 0, 0, 0.23)',\r\n    boxShadow: 'none',\r\n    marginBottom: theme.spacing(1),\r\n    textAlign: 'left'\r\n},\r\n}));\r\n\r\nfunction validURL(str) {\r\n  var pattern = new RegExp('^(https?:\\\\/\\\\/)?'+ // protocol\r\n    '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|'+ // domain name\r\n    '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))'+ // OR ip (v4) address\r\n    '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*'+ // port and path\r\n    '(\\\\?[;&a-z\\\\d%_.~+=-]*)?'+ // query string\r\n    '(\\\\#[-a-z\\\\d_]*)?$','i'); // fragment locator\r\n  return !!pattern.test(str);\r\n}\r\n\r\nconst FEED_QUERY = gql`\r\n  {\r\n    batchItem {\r\n      id\r\n      title\r\n      price\r\n      link\r\n      description\r\n      imageLink\r\n    }\r\n  }\r\n`\r\n\r\nconst ADD_ITEM_MUTATION = gql`\r\n  mutation addItem($title: String!, $price: [Float!]!, $link: String!, $description: String!, $imageLink: String!) {\r\n    addItem(\r\n      title: $title,\r\n      price: $price,\r\n      link: $link,\r\n      description: $description,\r\n      imageLink: $imageLink\r\n    )\r\n  }\r\n`\r\n\r\nconst REMOVE_ITEM_MUTATION = gql`\r\n  mutation removeItem($id: String!) {\r\n    removeItem(\r\n      id: $id\r\n    )\r\n  }\r\n`\r\n\r\nconst TaoItem = ({ item, edit, refresh }) => {\r\n  const classes = useStyles();\r\n\r\n  const [removeItem] = useMutation(REMOVE_ITEM_MUTATION);\r\n\r\n\r\n  const onClick = () => {\r\n    if (!validURL(item.link)) return;\r\n    window.open(item.link, \"_blank\")\r\n  }\r\n\r\n  const onRemoveButtonClick = async () => {\r\n    let { data } = await removeItem({ variables: { id: item.id } });\r\n    if (!data.removeItem) return;\r\n    refresh();\r\n  }\r\n\r\n  const onEditButtonClick = () => {\r\n\r\n  }\r\n\r\n  return (\r\n    <>\r\n      { edit && <div style={{marginBottom: 3, textAlign: 'right'}}>\r\n        <Button style={{backgroundColor:'lightblue', width: '20px !important', height: 20}}> EDIT </Button>\r\n        <Button onClick={onRemoveButtonClick} style={{backgroundColor:'lightsalmon', width: '20px !important', height: 20, marginLeft: 3}}> X </Button>\r\n      </div> }\r\n      <Card className={classes.root} onClick={onClick}>\r\n        <div className={classes.details}>\r\n          <CardContent className={classes.content}>\r\n              <Typography component=\"h6\" variant=\"h6\">\r\n                  {item.title}\r\n              </Typography>\r\n              <Typography>\r\n                  {item.price.length <= 1 ? \r\n                    `${item.price[0]}¥` :\r\n                    `${item.price[0]}-${item.price[1]}¥`\r\n                  }\r\n              </Typography>\r\n              <Typography variant=\"subtitle1\" color=\"textSecondary\">\r\n                  {item.description}\r\n              </Typography>\r\n          </CardContent>\r\n        </div>\r\n        <CardMedia\r\n            className={classes.cover}\r\n            image={item.imageLink || 'https://via.placeholder.com/150x150?text=No+Image'}\r\n        />\r\n      </Card>\r\n    </>\r\n  )\r\n}\r\n\r\nconst initialState = JSON.parse(JSON.stringify(propList));\r\n\r\nconst formReducer = (state, action) => {\r\n  switch (action.type) {\r\n      case 'UPDATE':\r\n        return produce(state, draft => {\r\n          _.set(draft, ...[action.path, action.value])\r\n        });\r\n      case 'RESET':\r\n        return initialState;\r\n      default:\r\n          return state;\r\n  }\r\n}\r\n\r\nconst Field = ({prop, formState, updateForm}) => {\r\n  const [name, attr] = prop;\r\n  \r\n  if (Array.isArray(attr)) return (\r\n    <div style={{display: 'flex'}}>\r\n      {attr.map((_, i) => (\r\n        <TextField\r\n          name={`${name}[${i}]`}\r\n          label={`${name} ${i}`}\r\n          key={`${name}[${i}]`}\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          size='small'\r\n          style={{marginBottom:5}}\r\n          onChange={updateForm}\r\n          value={get(formState, `${name}[${i}]`)}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <TextField\r\n        name={name}\r\n        label={name}\r\n        key={name}\r\n        fullWidth\r\n        variant=\"outlined\"\r\n        size='small'\r\n        style={{marginBottom:5}}\r\n        onChange={updateForm}\r\n        value={get(formState, `${name}`)}\r\n      />\r\n  );\r\n}\r\n\r\nconst Form = React.memo(function Form({formState, updateForm}) {\r\n  return (\r\n    Object.entries(propList).map((prop, i)=><Field prop={prop} formState={formState} updateForm={updateForm} key={i}/>)\r\n  )\r\n})\r\n\r\n\r\nconst NewItem = ({ refresh }) => {\r\n\r\n  const classes = useStyles();\r\n\r\n  const [addItem] = useMutation(ADD_ITEM_MUTATION);\r\n\r\n  const [formState, formDispatch] = React.useReducer(formReducer, initialState);\r\n\r\n  const updateForm = React.useCallback(({ target: { value, name, type } }) => {\r\n    formDispatch({\r\n        type: 'UPDATE',\r\n        path: name,\r\n        value: value\r\n    })\r\n  }, []);\r\n\r\n  const submitForm = async () => {\r\n    console.log(formState);\r\n    let submit = JSON.parse(JSON.stringify(formState));\r\n    submit.price[0] = Number(submit.price[0]);\r\n    submit.price[1] = Number(submit.price[1]);\r\n    let { data } = await addItem({ variables: submit });\r\n    if (data.addItem) {\r\n      formDispatch({\r\n        type: 'RESET',\r\n      })\r\n      refresh();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <br/>\r\n      <Card className={classes.edit} style={{padding:5}}>\r\n        <Form formState={formState} updateForm={updateForm}/>\r\n        <Button size='small' onClick={()=>submitForm('')} style={{backgroundColor: 'lightblue', float: 'right'}}>ADD</Button>\r\n      </Card>\r\n    </>\r\n  )\r\n}\r\n\r\nconst ItemListHomeDisplay = () => {\r\n\r\n  const { loading, error, data, refetch } = useQuery(FEED_QUERY);\r\n  const edit = !!(window.location.pathname === '/add')\r\n\r\n  return (\r\n      <>\r\n        {edit && <NewItem refresh={refetch}/>}\r\n        <br/>\r\n        <div>\r\n          {(() => {\r\n            if (loading) return <div>Fetching</div>\r\n            if (error) return <div>Error</div>\r\n\r\n            let itemList = data.batchItem\r\n            return (\r\n              itemList.map((item, i) => <TaoItem refresh={refetch} key={i} item={item} edit={edit}/>)\r\n            )\r\n          })()}\r\n        </div>\r\n      </>\r\n  )\r\n}\r\n\r\nexport { ItemListHomeDisplay };","import '../styles/App.css';\nimport { Button, Container, createMuiTheme, ThemeProvider } from '@material-ui/core';\nimport { ItemListHomeDisplay } from './ItemListHomeDisplay';\nimport React, { useEffect, useState } from 'react';\nimport {\n  BrowserRouter as HashRouter,\n  Switch,\n  Route,\n  Redirect,\n  Link,\n} from \"react-router-dom\";\nimport { gql } from 'apollo-boost';\nimport { useMutation } from 'react-apollo';\nimport * as Cookies from 'js-cookie'\n\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: [\n      '-apple-system',\n      'BlinkMacSystemFont',\n      '\"Noto Sans KR\"',\n      '\"Segoe UI\"',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n      '\"Apple Color Emoji\"',\n      '\"Segoe UI Emoji\"',\n      '\"Segoe UI Symbol\"',\n    ].join(','),\n  },\n});\n\nconst AUTH_CHECK = gql`\n  mutation {\n    isLogin\n  }\n`\n\nconst LOGIN = gql`\n  mutation login($id: String!, $pw: String!) {\n    login(id: $id, pw: $pw) {\n      token\n      id\n    }\n  }\n`\n\nconst Login = () => {\n  \n  const [login] = useMutation(LOGIN);\n  async function loginRequest(e) {\n    e.preventDefault();\n    let res = await login({\n      variables: {\n        id: e.target.elements.username.value,\n        pw: e.target.elements.pwd.value,\n      },\n    });\n    if (!res.data.login) {\n      alert(\"잘못된 계정 정보입니다.\");\n    } else {\n      let expires = new Date();\n      expires.setTime(expires.getTime() + (60*60*1000));\n      Cookies.set('authorization', res.data.login.token, { path: '/',  expires})\n      window.location.href = \"/add\";\n    }\n  }\n  return (\n    <>\n      <div className=\"text-center\">\n        <form onSubmit={(d) => loginRequest(d)}>\n          <h3>로그인</h3>\n          <div className=\"form-group\">\n            <label>아이디</label>\n            <input\n              name=\"username\"\n              className=\"form-control\"\n              placeholder=\"아이디 입력\"\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label>비밀번호</label>\n            <input\n              name=\"pwd\"\n              type=\"password\"\n              className=\"form-control\"\n              placeholder=\"비밀번호 입력\"\n            />\n          </div>\n\n          <button type=\"submit\" className=\"btn btn-primary btn-block\">\n            확인\n          </button>\n        </form>\n      </div>\n    </>\n  );\n}\n\nexport const UserAuth = React.createContext(null);\n\nfunction App() {\n\n  const [authCheck] = useMutation(AUTH_CHECK);\n  const [auth, setAuth] = useState(null);\n\n  useEffect(() => {\n    (async () => {\n      let { data } = await authCheck();\n      console.log(data.isLogin);\n      setAuth(value => data.isLogin);\n    })();\n  }, []);\n\n  const Home = () => (\n    <>\n      <Container maxWidth=\"sm\" style={{ /*backgroundColor: '#cfe8fc',*/ height: '100vh', padding: 0 }}>\n        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>\n          <h3>타오바오 잡템모음</h3>\n          {auth && <Link to={window.location.pathname === '/add' ? '/' : '/add'}><Button style={{backgroundColor: '#eee'}}>수정</Button></Link>}\n        </div>\n        <ItemListHomeDisplay/>\n      </Container>\n    </>\n  )\n\n  return (\n    <ThemeProvider theme={theme}>\n      <div className=\"App\">\n        <UserAuth.Provider value={auth}>\n          <HashRouter>\n            <Switch>\n              <Route path=\"/\" exact={true} component={Home} />\n              {auth && <Route path=\"/add\" exact={true} component={Home} />}\n              <Route path=\"/login\" exact={true} component={Login} />\n              <Redirect to=\"/\" />\n            </Switch>\n          </HashRouter>\n        </UserAuth.Provider>\n      </div>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './components/App';\n\nimport { ApolloProvider } from 'react-apollo';\nimport { ApolloClient } from 'apollo-client';\nimport { createHttpLink } from 'apollo-link-http';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\n\nimport * as Cookies from 'js-cookie'\n\nlet authorization = Cookies.get('authorization')\n\nconst httpLink = createHttpLink({\n  uri: 'https://sff-taobao-items-backend.herokuapp.com',\n  credentials: 'same-origin',\n  headers: authorization\n  ? {\n      Authorization: `${authorization}`\n    }\n  : {}\n})\n\nconst client = new ApolloClient({\n  link: httpLink,\n  cache: new InMemoryCache()\n})\n\nReactDOM.render(\n  <ApolloProvider client={client}>\n    <App />\n  </ApolloProvider>,\n  document.getElementById('root')\n)"],"sourceRoot":""}